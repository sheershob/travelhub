<% layout("layouts/boilerplate") %>

<div class="container mt-5">
    <h2 class="text-center mb-4">
    <h2>Welcome, <%= user.username %> </h2>
    <p class="text-muted">Your profile & bookings</p>
    </h2>
  <h3 class="text-center mb-4">My Bookings</h3>

  <% if (user.bookings.length === 0) { %>
    <div class="alert alert-info text-center">
      You have no bookings yet.
    </div>
  <% } %>

  <div class="row">
    <% for (let booking of user.bookings) { %>

      <div class="col-md-6 mb-4">
        <div class="card shadow-sm h-100">

          <img 
            src="<%= booking.listing.image?.url || '/images/default.jpg' %>" 
            class="card-img-top"
            style="height: 200px; object-fit: cover;"
          >

          <div class="card-body mx-3">

            <h5 class="card-title">
              <%= booking.listing.title %>
            </h5>

            <p class="text-muted mb-2">
              <i class="fa-solid fa-location-dot"></i>
              <%= booking.listing.location %>
            </p>

            <p class="mb-1">
              ✅ <strong>Check-in:</strong>
              <%= booking.checkIn.toDateString() %>
            </p>

            <p class="mb-1">
              ✅ <strong>Check-out:</strong>
              <%= booking.checkOut.toDateString() %>
            </p>

            <p class="fw-bold text-success mt-2">
              ₹ <%= booking.totalPrice %>
            </p>

            <a 
              href="/listings/<%= booking.listing._id %>" 
              class="btn btn-outline-dark btn-sm mb-2"
            >
              View Listing
            </a>

          </div>
        </div>
      </div>

    <% } %>
  </div>
</div>
